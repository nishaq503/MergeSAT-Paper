We piece together the sub-problems into the complete algorithm.
